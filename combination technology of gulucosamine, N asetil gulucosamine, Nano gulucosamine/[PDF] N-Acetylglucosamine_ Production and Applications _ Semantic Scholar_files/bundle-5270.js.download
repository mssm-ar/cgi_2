"use strict";(self.webpackChunks2=self.webpackChunks2||[]).push([[5270],{88270:(e,t,r)=>{r.d(t,{Z:()=>S});var i=r(10194),s=r(94184),n=r.n(s),a=r(45697),o=r.n(a),l=r(67294),c=r.n(l);const u=({isOpen:e})=>{const t=n()("facet-toggle__icon",{open:e});return c().createElement("div",{className:t},c().createElement(i.Z,{icon:"disclosure",width:"14",height:"14"}))};try{u.displayName="ToggleFacetContainer"}catch(e){}u.propTypes={isOpen:o().bool.isRequired};const p=u;var d=r(743),h=r(5835),m=r(75687),f=r(54505);class b extends m.Z{constructor(e,t,r){const i=r?"expand":"collapse";super(f.default.FACET_CONTAINER,{title:e,facets:t,action:i})}static create(e,t,r){return new b(e,t,r)}}var g=r(95512),y=r(25864);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},v.apply(this,arguments)}function E(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class P extends c().PureComponent{constructor(...e){super(...e),E(this,"handleContainerToggle",(()=>{this.setState({isOpen:!this.state.isOpen},(()=>{const{title:e,facets:t}=this.props,r="Publication Year"!==e?JSON.stringify(t.map((({value:e,documentCount:t})=>({value:e,documentCount:t})))):void 0;(0,y.Z)(b.create(e,r,this.state.isOpen))}))})),E(this,"_onClickKeyDownProps",(0,h.B6)({onClick:this.handleContainerToggle})),this.state={isOpen:this.props.openByDefault||!1}}render(){const{isOpen:e}=this.state,{testId:t,hideTitle:r,heapProps:i}=this.props,s=c().createElement("div",{className:"facet-content"},this.props.children),a=n()("flex-row-vcenter flex-space-between facet-toggle",{"is-inactive":!this.props.isActive});return c().createElement("section",v({"data-test-id":t},i?(0,d.ON)(i):{}),c().createElement("div",v({className:a},this.props.collapsible?this._onClickKeyDownProps:{}),!r&&c().createElement("h3",{className:"facet-content__header"},this.props.title),this.props.collapsible?c().createElement(p,{isOpen:e}):null),this.props.collapsible?e&&s:s)}}try{P.displayName="FacetContainer"}catch(e){}E(P,"contextTypes",{dispatcher:o().instanceOf(g.Z).isRequired}),E(P,"defaultProps",{isActive:!0,openByDefault:!1,collapsible:!0,hideTitle:!1});const S=P},58077:(e,t,r)=>{r.d(t,{Z:()=>j});var i=r(88270),s=r(75463),n=r(28893),a=r(52254),o=r(75687),l=r(54505);class c extends o.Z{constructor(e,t,r,i,s){const n=s?"disable":"enable";super(l.default.FACET,{action:n,facetType:e,facetValue:t,documentCount:r,index:i})}static create(e,t,r,i,s){return new c(e,t,r,i,s)}}class u extends o.Z{constructor(e,t){super(l.default.FACET,{value:e,count:t})}static create(e,t){return new u(e,t)}}var p=r(40228),d=r(5835),h=r(10194),m=r(94184),f=r.n(m),b=r(45697),g=r.n(b),y=r(67294),v=r.n(y);function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},E.apply(this,arguments)}class P extends y.PureComponent{constructor(...e){var t,r,i;super(...e),t=this,r="_onClickKeyDownProps",i=(0,d.B6)({onClick:this.props.onChange,overrideKeys:[p.JX]}),(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i}static propTypes(){return{children:g().element,selected:g().bool,disabled:g().bool,label:g().string,labelElement:g().element,onChange:g().func}}render(){const e=f()("flex-row-vcenter checkbox",{"is-selected":this.props.selected,"is-disabled":this.props.disabled}),t=this.props.labelElement?this.props.labelElement:v().createElement("label",{className:"checkbox-label"},this.props.label);return v().createElement("div",E({className:e,tabIndex:0,role:"checkbox","aria-checked":this.props.selected,"aria-labelledby":`checkbox-${t}`},this.props.disabled?{}:this._onClickKeyDownProps),v().createElement("div",{className:"checkbox-input flex-row-vcenter"},v().createElement(h.Z,{className:"check flex-centered",icon:"check",width:"12",height:"12"})),v().createElement("span",{id:`checkbox-${t}`},t),this.props.children)}}try{P.displayName="Checkbox"}catch(e){}var S=r(68028);function w(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class T extends y.PureComponent{constructor(...e){super(...e),w(this,"toggleFacet",(()=>{const{onFilterToggled:e,filterType:t,value:r,documentCount:i,index:s}=this.props,{router:n}=this.context,a=this.getQueryStore();"function"==typeof e&&e(this.state.selected,r,i,s),a.routeToToggleFilter(t,r,n)})),this.state=this.stateFromQueryStore(),this.getQueryStore().registerComponent(this,(()=>{this.setState(this.stateFromQueryStore())}))}getQueryStore(){return this.props.injectQueryStore||this.context.queryStore}stateFromQueryStore(){const{filterType:e,value:t,orMode:r}=this.props,i=this.getQueryStore(),s=0===i.getFilterDocumentCount(e,t),n=i.isFilterActive(e,t);return{disabled:s&&!n&&!r,selected:n}}render(){return v().createElement(P,{onChange:this.toggleFacet,label:this.props.label,labelElement:this.props.labelElement,selected:this.state.selected,disabled:this.state.disabled},this.props.children)}}try{T.displayName="FilterCheckbox"}catch(e){}w(T,"propTypes",{filterType:g().string.isRequired,orMode:g().bool,injectQueryStore:g().object,documentCount:g().number,value:g().string.isRequired,label:g().string,labelElement:g().element,index:g().number,onFilterToggled:g().func,children:g().object}),w(T,"contextTypes",{queryStore:g().instanceOf(S.Z).isRequired,router:g().object.isRequired});var C=r(98213);const x="HOVER",O="CLICK",N=100;var k=r(73935),V=r.n(k);function F(){return F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},F.apply(this,arguments)}function R(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class D extends y.PureComponent{constructor(e,...t){super(e,...t),R(this,"showTooltip",(()=>{clearTimeout(this.currentTimer),this.state.tooltipIsVisible||(this.currentTimer=setTimeout((()=>{this.setState({tooltipIsVisible:!0})}),N))})),R(this,"hideTooltip",(()=>{clearTimeout(this.currentTimer),this.state.tooltipIsVisible&&(this.currentTimer=setTimeout((()=>{this.setState({tooltipIsVisible:!1})}),N))})),R(this,"hideTooltipOnPageClick",(e=>{const t=this.refs.tooltip;e.target===t||t.contains(e.target)||this.hideTooltip(e)})),R(this,"toggleTooltip",(e=>{const t=V().findDOMNode(this);!this.state.tooltipIsVisible&&e&&t.contains(e.target)||t===e.target?this.showTooltip():this.hideTooltip()})),R(this,"_onClickKeyDownToggleProps",(0,d.B6)({onClick:this.toggleTooltip})),this.state={tooltipIsVisible:!1}}componentWillUnmount(){clearTimeout(this.currentTimer),this.listener&&(document.removeEventListener("click",this.listener),this.listener=void 0)}componentDidMount(){this.state.tooltipIsVisible&&(this.props.interactionType===O&&(this.listener=this.hideTooltipOnPageClick,document.addEventListener("click",this.listener)),"function"==typeof this.props.onShow&&this.props.onShow())}componentDidUpdate(e,t){!t.tooltipIsVisible&&this.state.tooltipIsVisible&&"function"==typeof this.props.onShow&&this.props.onShow(),!this.listener&&this.state.tooltipIsVisible&&this.props.interactionType===O?(this.listener=this.hideTooltipOnPageClick,document.addEventListener("click",this.listener)):this.listener&&(document.removeEventListener("click",this.listener),this.listener=void 0)}renderTooltipContent(){if(this.state.tooltipIsVisible){const e=["tooltip",`mod-tooltip-${this.props.tooltipPosition}`,this.props.tooltipClassName].join(" ").trim(),t=f()("tooltip-pointer-arrow",this.props.tooltipArrowClassName);return v().createElement("div",{className:e,ref:"tooltip"},v().createElement("span",{className:"tooltip-pointer"},v().createElement("span",{className:t})),this.props.tooltipContent)}return null}render(){const{envInfo:{isMobile:e}}=this.context,{testId:t}=this.props,r=f()("tooltip-parent",this.props.className,{"tooltip-mobile":e}),i=this.props.interactionType===O,s=this.props.interactionType===x;return v().createElement("div",F({className:r,onMouseEnter:s?this.showTooltip:null,onMouseLeave:s?this.hideTooltip:null},i?this._onClickKeyDownToggleProps:{},{"data-test-id":t}),this.props.children,this.renderTooltipContent())}}try{D.displayName="Tooltip"}catch(e){}R(D,"propTypes",{tooltipContent:g().node.isRequired,tooltipClassName:g().string,tooltipPosition:g().string,tooltipArrowClassName:g().string,className:g().string,onShow:g().func,interactionType:g().string,children:g().node,testId:g().string}),R(D,"defaultProps",{tooltipPosition:"bottom-right",interactionType:x}),R(D,"contextTypes",{envInfo:g().instanceOf(C.Z).isRequired});var M=r(25864);function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class j extends v().PureComponent{constructor(...e){super(...e),I(this,"handleFilterToggle",((e,t,r,i)=>{(0,M.Z)(c.create(this.props.filterType,t,r,i,e))})),I(this,"renderFilter",((e,t)=>{const{displayDocCount:r,filterType:i,hasSelection:s,injectQueryStore:n,maxLabelLength:o}=this.props,l=this.getQueryStore().isFilterActive(i,e.value),c=e.displayValue||e.value,u=e.documentCount,p=u>10?10*Math.floor((u+1)/10):u,d=s&&!l,h=!d&&r,m=o&&-1!==o?(0,a.aF)(c,o):c,f=h?(0,a.PS)(m,p):m,b=m===c?v().createElement("span",null,f):v().createElement(D,{tooltipClassName:"tooltip--default-size filter-list_facet-tooltip",tooltipContent:c,tooltipPosition:"bottom-left"},f),g=v().createElement("label",{className:"checkbox-label"},b);return v().createElement("li",{"data-test-id":`facet-row-${t}`,className:"facet-value",key:e.value},v().createElement(T,{injectQueryStore:n,onFilterToggled:this.handleFilterToggle,documentCount:u,filterType:i,value:e.value,orMode:d,labelElement:g,index:t}))}));const t=this.getQueryStore(),r=void 0!==this.props.filters.find((e=>t.isFilterActive(this.props.filterType,e.value)));this.state={openByDefault:r}}getQueryStore(){return this.props.injectQueryStore||this.context.queryStore}componentDidMount(){const{filterType:e,filters:t}=this.props,r=t.size;(0,M.Z)(u.create(e,r))}render(){const{filterType:e,filters:t,title:r}=this.props,a=(0,s.ef)(t),o=t.toList().map(this.renderFilter);return v().createElement(i.Z,{title:r,testId:e,heapProps:(0,n.MU)(e),isActive:a>0,facets:t,openByDefault:this.state.openByDefault,collapsible:!!this.props.collapsible},v().createElement("ul",{className:"facet-list"},o))}}try{j.displayName="FilterList"}catch(e){}I(j,"contextTypes",{queryStore:g().instanceOf(S.Z).isRequired}),I(j,"defaultProps",{collapsible:!0,maxLabelLength:-1,displayDocCount:!0})},214:(e,t,r)=>{r.d(t,{Z:()=>A});var i=r(52254),s=r(40228),n=r(5835),a=r(10194),o=r(45697),l=r.n(o),c=r(67294),u=r.n(c);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},p.apply(this,arguments)}const{bool:d,number:h,string:m}=l(),f={enabled:d.isRequired,count:h.isRequired,icon:m,onClick:l().func.isRequired,ariaLabelledBy:m},b=(e,t)=>`flex-row-vcenter checkbox ${e?"is-selected":""} ${0===t?"is-disabled":""}`,g=({enabled:e,count:t,icon:r,onClick:i,ariaLabelledBy:o})=>{const l=u().useMemo((()=>(0,n.B6)({onClick:i,overrideKeys:[s.JX]})),[i]);return u().createElement("div",{className:b(e,t)},u().createElement("div",p({className:`checkbox-input flex-row-vcenter ${r}`,"data-test-id":"facet-checkbox"},l,{tabIndex:0,role:"checkbox","aria-labelledby":o,"aria-checked":e}),u().createElement(a.Z,{className:"check flex-centered",icon:r,width:"12",height:"12"})))};try{g.displayName="FacetCheckbox"}catch(e){}g.propTypes=f,g.defaultProps={icon:"check"};const y=g;var v=r(94184),E=r.n(v);const P={facetValue:l().object.isRequired,isSelected:l().bool.isRequired,handleClick:l().func.isRequired,checkBoxIcon:l().string.isRequired,index:l().number.isRequired,displayCount:l().bool.isRequired},S=e=>{const{handleClick:t,isSelected:r,index:s,facetValue:n,checkBoxIcon:a,displayCount:o}=e,{value:l,documentCount:c}=n,p=E()("flex-row-vcenter checkbox facet-value",{"is-disabled":0===c,"is-selected":r}),d=o?(0,i.PS)(l,c):l;return u().createElement("li",{className:p,"data-test-id":`facet-row-${s}`},u().createElement(y,{enabled:r,count:c,icon:a,onClick:c>0?()=>t(l,r,c,s):void 0,ariaLabelledBy:`checkbox-${d}`}),u().createElement("span",{id:`checkbox-${d}`,className:"checkbox-label"},d))};try{S.displayName="Facet"}catch(e){}S.propTypes=P,S.defaultProps={checkBoxIcon:"check",displayCount:!0};const w=S;var T=r(75463),C=r(28893),x=r(14805),O=r(54505),N=r(63833),k=r(68028),V=r(78502),F=r(5436);function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},R.apply(this,arguments)}const D=({className:e,isSelected:t,isDisabled:r,text:i,testId:s,heapProps:n,onToggle:a})=>{const o=E()("fresh-filters__filter_container toggle",t?"selected":"unselected",e),l=E()("button",{"is-selected":t,"button--primary":t,"button--secondary":!t,"is-disabled":r});return u().createElement(F.Z,{className:o},u().createElement("button",R({"aria-pressed":t,onClick:a,className:l,disabled:r,"data-test-id":`${s}-filter-button`},n),i))};try{D.displayName="SearchToggle"}catch(e){}const M=D;var I=r(25864);function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},j.apply(this,arguments)}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function _(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class A extends u().PureComponent{constructor(...e){super(...e),_(this,"toggleHasPdfFilter",(()=>{const e=this.getQueryStore();(0,I.Z)(x.Z.create(O.default.FACET_HAS_PDF,{documentCount:this.state.countOfPapersWithViewablePdf,action:this.state.isSelected?"disable":"enable"})),N.Z.changeRouteForPartialQuery(e.getIndependentQuery(),e.getQuery().set("requireViewablePdf",!this.state.isSelected),this.context.history,this.context.router)}));const t=this.getQueryStore();this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromQueryStore()),t.registerComponent(this,(()=>{this.setState(this.getStateFromQueryStore())}))}getQueryStore(){return this.props.injectQueryStore||this.context.queryStore}getStateFromQueryStore(){const e=this.getQueryStore(),t=e.getQuery().requireViewablePdf||!1;let r=null;return r=this.props.forCitations&&null!=e.getAggregationResponse?e.getAggregationResponse().stats:e.getQueryResponse().stats,{isSelected:t,countOfPapersWithViewablePdf:r.get("countOfPapersWithViewablePdf")||0}}renderAsToggle(){const{className:e,disabled:t}=this.props,{isSelected:r,countOfPapersWithViewablePdf:i}=this.state;return u().createElement(M,{className:e,isSelected:r,isDisabled:0===i||!!t,text:"Has PDF",testId:"pdf-available",heapProps:(0,C.oU)(),onToggle:this.toggleHasPdfFilter})}renderAsFacet(){const{className:e}=this.props,{isSelected:t,countOfPapersWithViewablePdf:r}=this.state,i=(0,T.cH)({value:"Full text PDF available",documentCount:r});return u().createElement("ul",j({className:E()("facet-content","facet-content--without-container",e)},(0,C.qt)()),u().createElement(w,{handleClick:this.toggleHasPdfFilter,index:0,facetValue:i,isSelected:t}))}render(){return this.props.isToggle?this.renderAsToggle():this.renderAsFacet()}}try{A.displayName="HasViewablePdfFacet"}catch(e){}_(A,"propTypes",{className:l().string,isToggle:l().bool,injectQueryStore:l().object,disabled:l().bool,forCitations:l().bool}),_(A,"contextTypes",{history:l().instanceOf(V.ZP).isRequired,queryStore:l().instanceOf(k.Z).isRequired,router:l().object.isRequired})},3380:(e,t,r)=>{r.d(t,{Jk:()=>f,U3:()=>m,kQ:()=>p,sY:()=>d,wq:()=>h});var i=r(35369);const s="FIELD_OF_STUDY",n="AUTHOR",a="COAUTHOR",o="HAS_PDF",l="VENUE",c="DATE",u="CITATION_INTENT",p={FIELD_OF_STUDY:s,AUTHOR:n,COAUTHOR:a,HAS_PDF:o,VENUE:l,DATE:c,QUERY_TEXT:"QUERY_TEXT",CITATION_INTENT:u},d={startVisible:i.ZP.List([s,c,o,n,l]),startInModal:i.ZP.List(),collapseToModal:i.ZP.List([n,l]),includeClearOnQuery:!1},h={startVisible:i.ZP.List([a,o]),startInModal:i.ZP.List([c,s,l]),collapseToModal:i.ZP.List([a,o]),includeClearOnQuery:!0},m={startVisible:i.ZP.List([c,u,o,n]),startInModal:i.ZP.List([l,s]),collapseToModal:i.ZP.List([c,u,o,n]),includeClearOnQuery:!0},f={startVisible:i.ZP.List([s,c,o,n]),startInModal:i.ZP.List(),collapseToModal:i.ZP.List([n]),includeClearOnQuery:!0}},79049:(e,t,r)=>{r.d(t,{Z:()=>j});var i=r(39508),s=r(52254);const n={constants:{BUBBLE_WIDTH:30,DESKTOP_HANDLE_WIDTH:20,DESKTOP_OVERLAP_PADDING:2,MOBILE_HANDLE_WIDTH:30,MOBILE_OVERLAP_PADDING:4},clamp:(e,t,r)=>Math.max(t,Math.min(r,e)),getHandlePosition:(e,t,r)=>t(e)-(r-t.bandwidth())/2,getScaleValForVal(e,t){let r=t(e);for(;isNaN(r);)r=t(e-=1);return e},getHighHandleLabel(e,t,r){let i=e+r-1;return e===t&&(i=r>1?e+"-"+(e+r-1):e),i.toString()},getBubbleWidth:(e,t)=>e>1?2*t:t,getHandleWidth(e){return e?this.constants.MOBILE_HANDLE_WIDTH:this.constants.DESKTOP_HANDLE_WIDTH},getOverlapPadding(e){return e?this.constants.MOBILE_OVERLAP_PADDING:this.constants.DESKTOP_OVERLAP_PADDING}};var a=r(94184),o=r.n(a),l=r(45697),c=r.n(l),u=r(67294),p=r.n(u),d=r(73935),h=r.n(d);function m(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f extends u.PureComponent{constructor(...e){super(...e),m(this,"touchMove",(e=>{const t=e.changedTouches[0].pageX-this.slidingParams.boundingRect.left;this.handleDragMove(t)})),m(this,"touchEnd",(()=>{this.handleDragEnd()})),m(this,"mouseMove",(e=>{if(this.state.sliding){const t=e.clientX-this.slidingParams.boundingRect.left;this.handleDragMove(t)}})),m(this,"mouseUp",(e=>{0===e.button&&this.handleDragEnd((()=>{document.removeEventListener("mousemove",this.mouseMove),document.removeEventListener("mouseup",this.mouseUp)}))})),this.state={lowVal:this.props.lowVal||this.props.min,highVal:this.props.highVal||this.props.max,sliding:!1},this.slidingParams={boundingRect:null,otherVal:null,xScale:null}}componentWillReceiveProps(e){this.setState({lowVal:e.lowVal||e.min,highVal:e.highVal||e.max})}componentWillUnmount(){document.removeEventListener("mousemove",this.mouseMove),document.removeEventListener("mouseup",this.mouseUp)}handleDragStart(e,t,r=(()=>{})){t.preventDefault(),t.stopPropagation(),this.setState({sliding:!0},(()=>{const t="highVal"===e?"lowVal":"highVal";this.slidingParams.xScale=i.Z.xScale(this.props.min,this.props.max,this.props.step,this.props.width),this.slidingParams.boundingRect=h().findDOMNode(this).getBoundingClientRect(),this.slidingParams.otherVal=this.state[t],r()}))}handleDragMove(e){const t=n.clamp(s.lq(this.slidingParams.xScale,e),this.props.filteredMin||this.props.min,this.props.filteredMax||this.props.max),r=this.state.lowVal,i=this.state.highVal;this.setState({lowVal:Math.min(t,this.slidingParams.otherVal),highVal:Math.max(t+(this.props.step-1),this.slidingParams.otherVal)},(()=>{!this.props.onSliderMove||this.state.lowVal===r&&this.state.highVal===i||this.props.onSliderMove(this.state.lowVal,this.state.highVal)}))}handleDragEnd(e=(()=>{})){this.setState({sliding:!1},(()=>{this.props.onSliderChange(this.state.lowVal,this.state.highVal),e()}))}touchStart(e,t){this.handleDragStart(e,t)}mouseDown(e,t){0===t.button&&this.handleDragStart(e,t,(()=>{document.addEventListener("mousemove",this.mouseMove),document.addEventListener("mouseup",this.mouseUp)}))}getSliderControlEventHandlers(e){return this.props.isMobile?{onTouchStart:this.touchStart.bind(this,e),onTouchEnd:this.touchEnd,onTouchMove:this.touchMove}:{onMouseDown:this.mouseDown.bind(this,e)}}render(){const e=this.props.isMobile,t=i.Z.xScale(this.props.min,this.props.max,this.props.step,this.props.width),r=n.getScaleValForVal(this.state.lowVal,t),s=n.getScaleValForVal(this.state.highVal,t),a=n.getHandlePosition(r,t,n.getHandleWidth(e)),l=n.getHandlePosition(s,t,n.getHandleWidth(e)),c=n.getHandlePosition(this.props.min,t,n.getHandleWidth(e)),u=this.props.width-c,d=n.getHighHandleLabel(s,this.state.lowVal,this.props.step);let h=a,m=l;const f=h+n.getBubbleWidth(this.props.step,n.constants.BUBBLE_WIDTH)-m;a!==l&&f>0&&r!==s&&(h-=Math.round(f/n.getOverlapPadding(e)),m+=Math.round(f/n.getOverlapPadding(e)));const b=this.getSliderControlEventHandlers("lowVal"),g=this.getSliderControlEventHandlers("highVal");return p().createElement("div",{className:o()({slider:!0,sliding:this.state.sliding})},p().createElement("div",{className:"bar",style:{left:c,width:u}},p().createElement("div",{className:"selection",style:{left:a-c+n.getHandleWidth(e)/2,width:l-a}})),p().createElement("div",{className:"handle low",style:{left:a}},p().createElement("span",b)),p().createElement("div",{className:"handle high",style:{left:l}},p().createElement("span",g)),p().createElement("div",{className:"bubble value low",style:{left:h}},p().createElement("span",{"data-test-id":"slider-low-label"},r)),p().createElement("div",{className:"bubble value high",style:{left:m}},p().createElement("span",{"data-test-id":"slider-high-label"},d)))}}try{f.displayName="RangeSlider"}catch(e){}m(f,"propTypes",{min:c().number.isRequired,max:c().number.isRequired,step:c().number.isRequired,filteredMin:c().number,filteredMax:c().number,width:c().number.isRequired,lowVal:c().number.isRequired,highVal:c().number.isRequired,onSliderChange:c().func,onSliderMove:c().func,isMobile:c().bool.isRequired});var b=r(26570),g=r(14805),y=r(54505),v=r(88270),E=r(25864),P=r(5835),S=r(35369);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},w.apply(this,arguments)}const T=({years:e,filteredYears:t,onRangeSelect:r,rangeBegin:i,rangeEnd:n,text:a,showCount:o,testId:l,isButton:c})=>{const u=function(e,t,r,i){return(t.isEmpty()?e:t).filter((e=>e.year>=r&&e.year<=i))}(e,t,i,n),d=function(e){return e.reduce(((e,t)=>e+t.count),0)}(u),h=o&&!c?`${a} (${(0,s.WU)(d)})`:a,m=p().useMemo((()=>(0,P.B6)({onClick:()=>r(u.first().year,u.last().year)})),[u,r]);return d>0&&!u.isEmpty()?c?p().createElement("button",{className:"year-range-button button--secondary","data-test-id":`${l}-filter-button`,onClick:()=>r(u.first().year,u.last().year)},h):p().createElement("span",w({className:"year-range-preset clickable","data-test-id":`${l}-filter-link`},m),h):c?p().createElement("button",{className:"year-range-button button--secondary disabled"},h):p().createElement("span",{className:"year-range-preset"},h)};try{T.displayName="YearRangePresetLink"}catch(e){}T.propTypes={years:c().instanceOf(S.aV).isRequired,filteredYears:c().instanceOf(S.aV).isRequired,onRangeSelect:c().func.isRequired,rangeBegin:c().number.isRequired,rangeEnd:c().number.isRequired,showCount:c().bool,text:c().string.isRequired,testId:c().string.isRequired,isButton:c().bool},T.defaultProps={showCount:!0};const C=T;var x=r(96560),O=r(28893);function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},N.apply(this,arguments)}const k=({years:e,filteredYears:t,onRangeSelect:r,showCounts:i,isButton:s})=>{const n=new Date,a=n.getUTCFullYear(),o=n.getUTCMonth()>6?a:a-1,l=a-5,c=a-10;return p().createElement("ul",N({className:"year-range-presets"+(s?" buttons":"")},(0,O.xb)()),p().createElement("li",null,p().createElement(C,{years:e,filteredYears:t,onRangeSelect:r,rangeBegin:o,rangeEnd:a,showCount:i,text:(0,x.KF)((e=>e.serp.histogram.button.thisYear.title)),testId:"this-year",isButton:s})),p().createElement("li",null,p().createElement(C,{years:e,filteredYears:t,onRangeSelect:r,rangeBegin:l,rangeEnd:a,showCount:i,text:(0,x.KF)((e=>e.serp.histogram.button.lastFive.title)),testId:"last-five-years",isButton:s})),p().createElement("li",null,p().createElement(C,{years:e,filteredYears:t,onRangeSelect:r,rangeBegin:c,rangeEnd:a,showCount:i,text:(0,x.KF)((e=>e.serp.histogram.button.lastTen.title)),testId:"last-ten-years",isButton:s})))};try{k.displayName="YearRangePresets"}catch(e){}k.defaultProps={showCounts:!0,isButton:!1};const V=k;function F(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R({years:e,filteredYears:t}){const r=!t.isEmpty(),s=[{buckets:e,renderer:r?i.Z.bucketRenderers.unfilteredBuckets:i.Z.bucketRenderers.selectedBuckets}];return r&&s.push({buckets:t,renderer:i.Z.bucketRenderers.selectedBuckets}),s}class D extends p().PureComponent{constructor(...e){super(...e),F(this,"onYearFilterChange",((e,t)=>{(0,E.Z)(g.Z.create(this.props.analyticsEvent,{minYear:e,maxYear:t})),this.props.filterCallback(e,t)})),F(this,"onYearFilterMove",((e,t)=>{this.setState({yearSliderLowVal:e,yearSliderHighVal:t})})),F(this,"onYearBucketSelect",(e=>{const t=this.getYearStats(this.props);(!t.filteredMin||e.startKey>=t.filteredMin)&&(!t.filteredMax||e.endKey<=t.filteredMax)&&((0,E.Z)(g.Z.create(y.default.Serp.YEAR_BUCKET,{minYear:e.startKey,maxYear:e.endKey})),this.props.filterCallback(e.startKey,e.endKey))})),F(this,"filterPopoverCount",(e=>{const t=this.getYearStats(this.props),r=t.filteredYears||e.selectedStartYear<(t.selectedStartYear||t.min)||e.selectedEndYear>(t.selectedEndYear||t.max)||new S.aV,i=r.find((t=>t.startKey===e.startKey)),s=i&&i.count||0;return r?s:e.count})),this.state=this.getInitialYearFilterState(this.props)}getYearStats(e){const t=e.yearBuckets?e.yearBuckets:e.years;if(t&&t.size>1){const r=(0,b.io)(t,1),i=(0,b.io)(e.filteredYears,1,r.first().startKey),s=i.isEmpty()?null:i.first().startKey,n=i.isEmpty()?null:i.last().endKey,a=r.first().startKey,o=r.last().endKey,l=e.yearFilter.get("min"),c=e.yearFilter.get("max");return{years:r,filteredYears:i,min:a,max:o,filteredMin:s,filteredMax:n,selectedStartYear:l>o?a:Math.max(a,l),selectedEndYear:c<a?o:Math.min(o,c),step:1}}return null}getInitialYearFilterState(e){const t={yearSliderHighVal:null,yearSliderLowVal:null},r=this.getYearStats(e);return r&&(t.yearSliderLowVal=Math.max(r.selectedStartYear||r.min,r.filteredMin||Number.MIN_VALUE),t.yearSliderHighVal=Math.min(r.selectedEndYear||r.max,r.filteredMax||Number.MAX_VALUE)),t}componentWillReceiveProps(e){this.setState(this.getInitialYearFilterState(e))}renderHistogram(e){return p().createElement(i.Z,{id:"filters",width:this.props.histogramWidth,height:this.props.histogramHeight,useLogScale:!0,bucketRenderers:R(e),renderPopover:!0,onBucketClick:this.onYearBucketSelect,filterPopoverCount:this.filterPopoverCount,minSelected:this.state.yearSliderLowVal,maxSelected:this.state.yearSliderHighVal,paddingBottomPx:this.props.renderXAxis?i.Z.DefaultPaddingPx.BOTTOM:0,renderAxis:this.props.renderXAxis,showOnlyFirstAndLastXAxisValues:this.props.renderXAxis,popoverLabel:this.props.popoverLabel,centerBucketPopover:this.props.centerBucketPopover})}render(){const e=this.getYearStats(this.props),{wrapperClass:t}=this.props;if(e){const r=p().createElement("div",{className:o()("year-filter__histogram",t)},this.renderHistogram(e),p().createElement(f,{onSliderChange:this.onYearFilterChange,onSliderMove:this.onYearFilterMove,width:this.props.histogramWidth,min:e.min,max:e.max,step:e.step,filteredMin:e.filteredMin,filteredMax:e.filteredMax,lowVal:this.state.yearSliderLowVal,highVal:this.state.yearSliderHighVal,isMobile:this.props.isMobile}),this.props.showPresets&&!this.props.showPresetButtons?p().createElement(V,{years:this.props.years,filteredYears:this.props.filteredYears,onRangeSelect:this.onYearFilterChange,showCounts:this.props.showPresetFilterCounts}):null,this.props.showPresetButtons?p().createElement(V,{years:this.props.years,filteredYears:this.props.filteredYears,onRangeSelect:this.onYearFilterChange,isButton:!0}):null);return this.props.renderInFacetContainer?p().createElement(v.Z,{title:"Publication Year",testId:"years",openByDefault:!0,collapsible:this.props.collapsible,facets:e.years},r):r}return null}}try{D.displayName="YearFilter"}catch(e){}F(D,"propTypes",{analyticsEvent:c().string.isRequired,centerBucketPopover:c().bool,years:c().instanceOf(S.aV).isRequired,filteredYears:c().instanceOf(S.aV).isRequired,isMobile:c().bool.isRequired,filterCallback:c().func.isRequired,histogramWidth:c().number.isRequired,histogramHeight:c().number.isRequired,renderInFacetContainer:c().bool,showPresets:c().bool,showPresetFilterCounts:c().bool,renderXAxis:c().bool,collapsible:c().bool,yearBuckets:c().instanceOf(S.aV),yearFilter:c().object,popoverLabel:c().string,wrapperClass:c().string,showPresetButtons:c().bool}),F(D,"defaultProps",{renderInFacetContainer:!0,showPresets:!0,showPresetFilterCounts:!0,renderXAxis:!1,collapsible:!0});var M=r(98213);function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class j extends p().PureComponent{render(){const{analyticsEvent:e,centerBucketPopover:t,filters:r,filterCallback:i,histogramWidth:s,histogramHeight:n,yearBuckets:a,yearFilter:o,popoverLabel:l,wrapperClass:c}=this.props,u=a||r.get("years");return p().createElement(D,{analyticsEvent:e,centerBucketPopover:t,years:u,filterCallback:i,filteredYears:r.get("filteredYears")||new S.ZP.List,isMobile:this.context.envInfo.isMobile,histogramWidth:s,histogramHeight:n,renderXAxis:!1,showPresets:!1,renderInFacetContainer:!1,yearBuckets:a,yearFilter:o,popoverLabel:l,wrapperClass:c,showPresetButtons:this.props.showPresetButtons})}}try{j.displayName="FilterByYearHistogram"}catch(e){}I(j,"contextTypes",{envInfo:c().instanceOf(M.Z).isRequired}),I(j,"defaultProps",{histogramHeight:50,histogramWidth:300})},84157:(e,t,r)=>{r.d(t,{Z:()=>E});var i=r(51261),s=r(96560),n=r(29212),a=r(19244),o=r(3724),l=r(88598),c=r(38953),u=r(66929),p=r(36898),d=r(54505),h=r(45793),m=r(49381),f=r(25864),b=r(67294),g=r.n(b);const y=({paper:e,query:t})=>{const r=(0,n.LA)({query:t||"",text:e.tldr&&e.tldr.text||""});return g().createElement(g().Fragment,null,g().createElement(u.default,{className:"tldr-abstract__pill",contents:()=>g().createElement(v,{paper:e})},g().createElement(c.default,{className:"tldr-abstract-replacement__pill mod-clickable",label:(0,s.KF)((e=>e.tldr.tldrLabel))})),g().createElement(h.ZP,{field:r,expandable:!1}))};try{y.displayName="PaperTldr"}catch(e){}const v=({paper:e})=>{const{dispatcher:t}=(0,l.bp)(),r=g().useContext(i.E),n=g().useCallback((e=>{e.preventDefault(),t.dispatch((0,o.K)({id:a.Z.FEEDBACK}))}),[t]);return g().useEffect((()=>{if(r){const t=d.default.getIn(r,"Tldr","DROPDOWN");(0,f.Z)(new m.Z(t,{corpusId:e.corpusId}))}}),[r]),g().createElement("div",{className:"tldr-abstract__popover"},g().createElement("p",{className:"tldr-abstract__popover__description"},(0,s.KF)((e=>e.tldr.tooltip.description))),g().createElement("hr",{className:"tldr-abstract__popover__line"}),g().createElement("p",{className:"tldr-abstract__popover__feedback"},(0,s.KF)((e=>e.tldr.tooltip.feedback)),g().createElement(p.default,{label:(0,s.KF)((e=>e.tldr.tooltip.contactUsLink)),onClick:n}),"."))};try{v.displayName="DropDownContents"}catch(e){}const E=y},78459:(e,t,r)=>{r.d(t,{A:()=>y,Z:()=>E});var i=r(28483),s=r(51261),n=r(96560),a=r(38953),o=r(14805),l=r(58348),c=r(34707),u=r(54505),p=r(45793),d=r(84157),h=r(25864),m=r(94184),f=r.n(m),b=r(67294),g=r.n(b);const y=90,v=({paper:e,query:t,className:r,abstract:m,tldr:b})=>{const[v,E]=g().useState(!1),P=g().useContext(s.E),{onToggleAbstract:S}=g().useContext(i.fC),w=g().useRef(null),T=g().useRef(null),C=g().useRef(!1),x=g().useCallback(((t,r)=>{if(r.stopPropagation(),S({expandState:t}),P&&e.has("corpusId")){const r=t===p.qr?"MORE":"LESS",i=u.default.getIn(P,"Tldr",r);(0,h.Z)(new o.Z(i,{corpusID:e.corpusId}))}E(t===p.qr)}),[S]);g().useEffect((()=>{var e;return C&&C.current?null!=T.current&&(null===(e=T.current.querySelector(".more-toggle"))||void 0===e||e.focus()):C.current=!0,()=>{var e;return clearTimeout(null!==(e=w.current)&&void 0!==e?e:void 0)}}),[v]);const O=g().useCallback((e=>x(p.qr,e)),[x]),N=g().useCallback((e=>x(p.GP,e)),[x]);return e.tldr?e.tldr.abstractSimilarityScore&&e.tldr.abstractSimilarityScore>y?g().createElement(l.default,{paper:e,className:r}):g().createElement("div",{ref:T,className:f()("tldr-abstract-replacement text-truncator",r)},!0===b?g().createElement(d.Z,{paper:e,query:t}):b,!v&&g().createElement(a.default,{"aria-label":(0,n.KF)((e=>e.textTruncator.default.extendAriaLabel)),label:(0,n.KF)((e=>e.textTruncator.default.extendLabel)),className:"more mod-clickable more-toggle",onClick:O,type:a.TYPE.TERTIARY}),!!v&&g().createElement("div",null,g().createElement(c.default,{className:"tldr-abstract__rule"}),!0===m?g().createElement("div",null,g().createElement("div",{className:"tldr-abstract__pill"},g().createElement("span",{className:"tldr-abstract-replacement__pill"},(0,n.KF)((e=>e.tldr.abstractLabel)))),g().createElement(p.ZP,{field:e.paperAbstract,fullTextClassName:"full-abstract"})):m," ",g().createElement(a.default,{"aria-label":(0,n.KF)((e=>e.textTruncator.default.truncateAriaLabel)),label:(0,n.KF)((e=>e.textTruncator.default.truncateLabel)),className:"more mod-clickable more-toggle",onClick:N,type:a.TYPE.TERTIARY}))):g().createElement(l.default,{paper:e,className:r})};try{v.displayName="TldrToggle"}catch(e){}v.defaultProps={abstract:!0,tldr:!0};const E=v},74507:(e,t,r)=>{function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{Q:()=>n});class s{constructor(e,t,r){i(this,"id",void 0),i(this,"pluralId",void 0),i(this,"displayName",void 0),this.id=e,this.pluralId=t,this.displayName=r}}const n={AUTHOR:new s("author","authors","Authors"),COAUTHOR:new s("coAuthor","coAuthors","Co-Authors"),VENUE:new s("venue","venues","Venues"),FIELDS_OF_STUDY:new s("fieldOfStudy","fieldsOfStudy","Fields of Study")}}}]);
//# sourceMappingURL=bundle-5270.js.map